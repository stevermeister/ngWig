{"version":3,"sources":["ng-wig.js"],"names":[],"mappings":";;;;;AAGA,QAAQ,MAAR,CAAe,OAAf,EAAwB,CAAC,qBAAD,CAAxB;AACA,QAAQ,KAAR,GAAgB;AACd,WAAS;AADK,CAAhB;;AAIA,QAAQ,MAAR,CAAe,OAAf,EACG,SADH,CACa,aADb,EAC4B;AACxB,YAAU;AACR,YAAQ,GADA;AAER,iBAAa,GAFL;AAGR,cAAU,GAHF;AAIR,cAAU,GAJF;AAKR,aAAS;AALD,GADc;AAQxB,cAAY,CAAC,QAAD,EAAW,UAAX,EAAuB,UAAvB,EAAmC,UAAS,MAAT,EAAiB,QAAjB,EAA2B,QAA3B,EAAqC;AAClF,aAAS,WAAT,CAAqB,SAAS,MAAM,KAAK,MAAL,CAAY,UAAlB,GAA+B,GAA/B,GAC5B,SAD4B,GAChB,gBADgB,GAE5B,eAF4B,GAEV,qBAFU,GAG5B,YAH4B,GAGb,kBAHa,GAI5B,WAJ4B,GAId,kBAJc,GAK5B,UAL4B,GAKf,iBALe,GAM5B,IANmB,EAMb,MANa,CAArB;AAOD,GARW;AARY,CAD5B;AAmBA,QAAQ,MAAR,CAAe,OAAf,EAAwB,QAAxB,CAAiC,cAAjC,EAAiD,YAAY;;AAE3D,MAAI,gBAAgB;AAClB,WAAO,EAAC,OAAO,gBAAR,EAA0B,SAAS,qBAAnC,EAA0D,YAAY,SAAtE,EADW;AAElB,WAAO,EAAC,OAAO,cAAR,EAAwB,SAAS,mBAAjC,EAAsD,YAAY,SAAlE,EAFW;AAGlB,UAAM,EAAC,OAAO,MAAR,EAAgB,SAAS,MAAzB,EAAiC,YAAY,MAA7C,EAHY;AAIlB,YAAQ,EAAC,OAAO,QAAR,EAAkB,SAAS,QAA3B,EAAqC,YAAY,QAAjD,EAJU;AAKlB,UAAM,EAAC,OAAO,MAAR,EAAgB,SAAS,YAAzB,EAAuC,YAAY,MAAnD;AALY,GAApB;;AAQA,MAAI,qBAAqB,CAAC,OAAD,EAAU,OAAV,EAAmB,MAAnB,EAA2B,QAA3B,EAAqC,MAArC,CAAzB;;AAEA,MAAI,iBAAiB,SAAjB,cAAiB,GAAY;AAC/B,WAAO,KAAK,OAAL,IAAgB,SAAS,iBAAT,CAA2B,KAAK,OAAhC,CAAvB;AACD,GAFD;;AAIA,OAAK,UAAL,GAAkB,UAAS,OAAT,EAAkB;AAClC,QAAG,CAAC,QAAQ,OAAR,CAAgB,OAAhB,CAAJ,EAA8B;AAC5B,YAAM,uCAAN;AACD;;AAED,yBAAqB,OAArB;AACD,GAND;;AAQA,OAAK,iBAAL,GAAyB,UAAU,IAAV,EAAgB,KAAhB,EAAuB,OAAvB,EAAgC,UAAhC,EAA4C;AACnE,QAAG,CAAC,IAAD,IAAS,CAAC,KAAV,IAAmB,CAAC,OAAvB,EAAgC;AAC9B,YAAM,sDAAN;AACD;;AAED,iBAAa,cAAc,EAA3B;AACA,kBAAc,IAAd,IAAsB,EAAC,OAAO,KAAR,EAAe,SAAS,OAAxB,EAAiC,YAAY,UAA7C,EAAtB;AACA,uBAAmB,IAAnB,CAAwB,IAAxB;AACD,GARD;;AAUA,OAAK,eAAL,GAAuB,UAAU,IAAV,EAAgB,UAAhB,EAA4B;AACjD,QAAG,CAAC,IAAD,IAAS,CAAC,UAAb,EAAyB;AACvB,YAAM,gDAAN;AACD;;AAED,kBAAc,IAAd,IAAsB,EAAC,YAAY,UAAb,EAAyB,WAAW,IAApC,EAAtB;AACA,uBAAmB,IAAnB,CAAwB,IAAxB;AACD,GAPD;;AASA,OAAK,IAAL,GAAY,YAAY;AACtB,WAAO;AACL,yBAAmB,2BAAS,IAAT,EAAe;AAChC,YAAI,iBAAiB,EAArB;AACA,SAAC,QAAQ,kBAAT,EAA6B,OAA7B,CAAqC,UAAS,SAAT,EAAoB;AACvD,cAAG,CAAC,cAAc,SAAd,CAAJ,EAA8B;AAC5B,kBAAM,kBAAkB,SAAlB,GAA8B,wCAA9B,GAAyE,OAAO,IAAP,CAAY,aAAZ,CAA/E;AACD;;AAED,cAAI,SAAS,QAAQ,IAAR,CAAa,cAAc,SAAd,CAAb,CAAb;;AAEA,cAAG,CAAC,QAAQ,UAAR,CAAmB,OAAO,QAA1B,CAAJ,EAAyC;AACvC,mBAAO,QAAP,GAAkB,cAAlB;AACD;;AAED,yBAAe,IAAf,CAAoB,MAApB;AACD,SAZD;AAaA,eAAO,cAAP;AACD;AAjBI,KAAP;AAmBD,GApBD;AAsBD,CAjED;AAkEA,QAAQ,MAAR,CAAe,OAAf,EACG,SADH,CACa,OADb,EACsB;AAClB,YAAU;AACR,aAAS,UADD;AAER,aAAS,IAFD;AAGR,aAAS,GAHD;AAIR,aAAS,GAJD;AAKR,uBAAmB,GALX;AAMR,sBAAkB;AANV,GADQ;AASlB,WAAS;AACP,uBAAmB;AADZ,GATS;AAYlB,eAAa,0BAZK;AAalB,cAAY,CAAC,QAAD,EAAW,UAAX,EAAuB,IAAvB,EAA6B,QAA7B,EAAuC,SAAvC,EAAkD,WAAlD,EAA+D,cAA/D,EAA+E,UAAS,MAAT,EAAiB,QAAjB,EAA2B,EAA3B,EAA+B,MAA/B,EAAuC,OAAvC,EAAgD,SAAhD,EAA2D,YAA3D,EAAyE;AAAA;;AAElK,QAAI,aAAa,QAAQ,OAAR,CAAgB,SAAS,CAAT,EAAY,aAAZ,CAA0B,kBAA1B,CAAhB,CAAjB;;;AAGA,SAAK,QAAL,GAAgB,cAAc,MAA9B;AACA,SAAK,mBAAL,GAA2B,uBAAuB,MAAlD;AACA,SAAK,QAAL,GAAgB,KAAhB;AACA,SAAK,cAAL,GAAsB,aAAa,iBAAb,CAA+B,KAAK,OAAL,IAAgB,aAAa,KAAK,OAAlB,CAA/C,CAAtB;AACA,WAAO,QAAP,CAAgB,UAAhB,EAA4B,UAAC,UAAD,EAAgB;AAC1C,YAAK,QAAL,GAAgB,UAAhB;AACA,iBAAW,IAAX,CAAgB,iBAAhB,EAAmC,CAAC,UAApC;AACD,KAHD;AAIA,SAAK,cAAL,GAAsB;AAAA,aAAM,WAAW,CAAX,MAAkB,UAAU,CAAV,EAAa,aAArC;AAAA,KAAtB;AACA,SAAK,cAAL,GAAsB,YAAM;AAC1B,YAAK,QAAL,GAAgB,CAAC,MAAK,QAAtB;AACA,UAAI,QAAQ,YAAR,GAAuB,eAA3B,EAA4C;AAC1C,gBAAQ,YAAR,GAAuB,eAAvB;AACD;AACF,KALD;;AAOA,SAAK,WAAL,GAAmB,UAAC,OAAD,EAAU,OAAV,EAAsB;AACvC,UAAI,MAAK,QAAT,EAAmB,OAAO,KAAP;;AAEnB,UAAI,YAAY,YAAhB,EAA8B;AAC5B,kBAAU,QAAQ,MAAR,CAAe,sBAAf,EAAuC,SAAvC,CAAV;AACA,YAAI,CAAC,OAAL,EAAc;AACZ;AACD;AACF;AACD,YAAK,iBAAL,CAAuB,EAAC,SAAS,OAAV,EAAmB,SAAS,OAA5B,EAAvB;AACA,aAAO,UAAP,CAAkB,aAAlB,EAAiC,EAAC,SAAS,OAAV,EAAmB,SAAS,OAA5B,EAAjC;AACA,YAAK,gBAAL,CAAsB,EAAC,SAAS,OAAV,EAAmB,SAAS,OAA5B,EAAtB;AACD,KAZD;;AAcA,SAAK,OAAL,GAAe,YAAM;;AAEnB,YAAK,iBAAL,CAAuB,OAAvB,GAAiC;AAAA,eAAM,WAAW,IAAX,CAAgB,MAAK,iBAAL,CAAuB,UAAvB,IAAqC,EAArD,CAAN;AAAA,OAAjC;;AAEA,iBAAW,IAAX,CAAgB,+BAAhB,EAAiD,YAAM;;AAErD,cAAK,iBAAL,CAAuB,aAAvB,CAAqC,WAAW,IAAX,EAArC;AACA,eAAO,WAAP;AACD,OAJD;AAKD,KATD;;AAWA,eAAW,EAAX,CAAc,OAAd,EAAuB,UAAC,KAAD,EAAW;AAChC,UAAG,CAAC,OAAO,OAAX,EAAmB;AACjB;AACD;;AAED,UAAI,qBAAJ;AACA,UAAI,OAAO,aAAP,IAAwB,OAAO,aAAP,CAAqB,OAAjD,EAA0D;;AACxD,uBAAe,OAAO,aAAP,CAAqB,OAArB,CAA6B,MAA7B,CAAf;AACD,OAFD,MAGI;AACF,uBAAe,CAAC,MAAM,aAAN,IAAuB,KAAxB,EAA+B,aAA/B,CAA6C,OAA7C,CAAqD,YAArD,CAAf;AACD;AACD,YAAM,cAAN;AACA,SAAG,IAAH,CAAQ,MAAK,OAAL,CAAa,EAAC,QAAQ,KAAT,EAAgB,cAAc,YAA9B,EAAb,CAAR,EAAmE,IAAnE,CAAwE,UAAC,SAAD,EAAe;AACrF,yBAAiB,SAAjB;AACD,OAFD;AAGD,KAhBD;;AAkBA,WAAO,GAAP,CAAW,aAAX,EAA0B,UAAC,KAAD,EAAQ,MAAR,EAAmB;AAC3C,YAAM,eAAN,IAAyB,MAAM,eAAN,EAAzB;AACA,iBAAW,CAAX,EAAc,KAAd;;AAEA,UAAI,uBAAuB,UAAU,CAAV,EAAa,SAAxC;UACE,UAAU,OAAO,OADnB;UAEE,UAAU,OAAO,OAFnB;;AAIA,UAAI,oBAAJ,EAA0B;AACxB,YAAI,YAAY,qBAAqB,WAArB,EAAhB;AACD;;AAED,UAAI,UAAU,CAAV,EAAa,qBAAb,IAAsC,CAAC,UAAU,CAAV,EAAa,qBAAb,CAAmC,OAAnC,CAA3C,EAAwF;AACtF,cAAM,kBAAkB,OAAlB,GAA4B,oBAAlC;AACD;;AAED,gBAAU,CAAV,EAAa,WAAb,CAAyB,OAAzB,EAAkC,KAAlC,EAAyC,OAAzC;;AAEA,UAAI,oBAAJ,EAA0B;AACxB,kBAAU,QAAV,CAAmB,KAAnB;AACA,kBAAU,MAAV;AACD;AACF,KAtBD;AAwBD,GAxFW;AAbM,CADtB;;;AA2GA,SAAS,YAAT,CAAsB,UAAtB,EAAkC;AAChC,SAAO,WAAW,KAAX,CAAiB,GAAjB,EAAsB,GAAtB,CAA0B,SAAS,SAAT,CAAmB,IAA7C,EAAmD,OAAO,SAAP,CAAiB,IAApE,CAAP;AACD;;;AAID,SAAS,gBAAT,CAA0B,IAA1B,EAAgC;AAC9B,MAAI,GAAJ,EAAS,KAAT;AACA,MAAI,OAAO,YAAX,EAAyB;AACvB,UAAM,OAAO,YAAP,EAAN;AACA,QAAI,IAAI,UAAJ,IAAkB,IAAI,UAA1B,EAAsC;AACpC,cAAQ,IAAI,UAAJ,CAAe,CAAf,CAAR;AACA,YAAM,cAAN;;;;AAIA,UAAI,KAAK,SAAS,aAAT,CAAuB,KAAvB,CAAT;AACA,SAAG,SAAH,GAAe,IAAf;AACA,UAAI,OAAO,SAAS,sBAAT,EAAX;UAA8C,IAA9C;UAAoD,QAApD;AACA,aAAS,OAAO,GAAG,UAAnB,EAAiC;AAC/B,mBAAW,KAAK,WAAL,CAAiB,IAAjB,CAAX;AACD;AACD,YAAM,UAAN,CAAiB,IAAjB;;;AAGA,UAAI,QAAJ,EAAc;AACZ,gBAAQ,MAAM,UAAN,EAAR;AACA,cAAM,aAAN,CAAoB,QAApB;AACA,cAAM,QAAN,CAAe,IAAf;AACA,YAAI,eAAJ;AACA,YAAI,QAAJ,CAAa,KAAb;AACD;AACF;AACF,GAzBD,MAyBO,IAAI,SAAS,SAAT,IAAsB,SAAS,SAAT,CAAmB,IAAnB,IAA2B,SAArD,EAAgE;;AAErE,aAAS,SAAT,CAAmB,WAAnB,GAAiC,SAAjC,CAA2C,IAA3C;AACD;AACF;AACD,QAAQ,MAAR,CAAe,OAAf,EACK,MADL,CACY,CAAC,sBAAD,EAAyB,UAAU,oBAAV,EAAgC;AAC9D,uBAAqB,eAArB,CAAqC,SAArC,EAAgD,mBAAhD;AACF,CAFO,CADZ,EAIK,SAJL,CAIe,iBAJf,EAIkC;AAC1B,YAAU;AACN,iBAAa,GADP;AAEN,cAAU,GAFJ;AAGN,cAAU;AAHJ,GADgB;AAM1B,oWAN0B;AAW1B,cAAY,sBAAW;;AAEnB,SAAK,OAAL,GAAe,CACX,EAAC,MAAM,aAAP,EAAsB,OAAO,GAA7B,EADW,EAEX,EAAC,MAAM,UAAP,EAAmB,OAAO,IAA1B,EAFW,EAGX,EAAC,MAAM,UAAP,EAAmB,OAAO,IAA1B,EAHW,EAIX,EAAC,MAAM,UAAP,EAAmB,OAAO,IAA1B,EAJW,CAAf;;AAOA,SAAK,MAAL,GAAc,KAAK,OAAL,CAAa,CAAb,CAAd;AACH;AArByB,CAJlC;;AA6BA,QAAQ,MAAR,CAAe,qBAAf,EAAsC,CAAC,0BAAD,CAAtC;;AAEA,QAAQ,MAAR,CAAe,0BAAf,EAA2C,EAA3C,EAA+C,GAA/C,CAAmD,CAAC,gBAAD,EAAmB,UAAS,cAAT,EAAyB;AAC7F,iBAAe,GAAf,CAAmB,0BAAnB,EACE,6BACA,+BADA,GAEA,oFAFA,GAGA,6CAHA,GAIA,qCAJA,GAKA,+DALA,GAMA,gDANA,GAOA,oEAPA,GAQA,0HARA,GASA,uEATA,GAUA,kCAVA,GAWA,uBAXA,GAYA,kBAZA,GAaA,4CAbA,GAcA,4BAdA,GAeA,oDAfA,GAgBA,mCAhBA,GAiBA,6CAjBA,GAkBA,6CAlBA,GAmBA,4DAnBA,GAoBA,kBApBA,GAqBA,iBArBA,GAsBA,0CAtBA,GAuBA,iCAvBA,GAwBA,uDAxBA,GAyBA,qCAzBA,GA0BA,sEA1BA,GA2BA,qDA3BA,GA4BA,qDA5BA,GA6BA,iDA7BA,GA8BA,qBA9BA,GA+BA,mBA/BA,GAgCA,aAhCA,GAiCA,WAjCA,GAkCA,IAlCA,GAmCA,yCAnCA,GAoCA,2EApCA,GAqCA,8CArCA,GAsCA,kDAtCA,GAuCA,wDAvCA,GAwCA,cAxCA,GAyCA,gFAzCA,GA0CA,qCA1CA,GA2CA,8BA3CA,GA4CA,uCA5CA,GA6CA,4DA7CA,GA8CA,6CA9CA,GA+CA,+BA/CA,GAgDA,gBAhDA,GAiDA,cAjDA,GAkDA,YAlDA,GAmDA,UAnDA,GAoDA,EArDF;AAsDD,CAvDkD,CAAnD","file":"ng-wig.js","sourcesContent":["/**\n * version: 3.0.1\n */\nangular.module('ngWig', ['ngwig-app-templates']);\nangular.ngWig = {\n  version: '3.0.1'\n};\n\nangular.module('ngWig')\n  .component('ngWigPlugin', {\n    bindings: {\n      plugin: '<',\n      execCommand: '=',\n      editMode: '=',\n      disabled: '=',\n      options: '<'\n    },\n    controller: [\"$scope\", \"$element\", \"$compile\", function($scope, $element, $compile) {\n      $element.replaceWith($compile('<' + this.plugin.pluginName + ' ' +\n        'plugin=' + '\"$ctrl.plugin\"' +\n        'exec-command=' + '\"$ctrl.execCommand\"' +\n        'edit-mode=' + '\"$ctrl.editMode\"' +\n        'disabled=' + '\"$ctrl.disabled\"' +\n        'options=' + '\"$ctrl.options\"' +\n        '/>')($scope));\n    }]\n  });\nangular.module('ngWig').provider('ngWigToolbar', function () {\n\n  var buttonLibrary = {\n    list1: {title: 'Unordered List', command: 'insertunorderedlist', styleClass: 'list-ul'},\n    list2: {title: 'Ordered List', command: 'insertorderedlist', styleClass: 'list-ol'},\n    bold: {title: 'Bold', command: 'bold', styleClass: 'bold'},\n    italic: {title: 'Italic', command: 'italic', styleClass: 'italic'},\n    link: {title: 'Link', command: 'createlink', styleClass: 'link'}\n  };\n\n  var defaultButtonsList = ['list1', 'list2', 'bold', 'italic', 'link'];\n\n  var isButtonActive = function () {\n    return this.command && document.queryCommandState(this.command);\n  };\n\n  this.setButtons = function(buttons) {\n    if(!angular.isArray(buttons)) {\n      throw 'Argument \"buttons\" should be an array';\n    }\n\n    defaultButtonsList = buttons;\n  };\n\n  this.addStandardButton = function (name, title, command, styleClass) {\n    if(!name || !title || !command) {\n      throw 'Arguments \"name\", \"title\" and \"command\" are required';\n    }\n\n    styleClass = styleClass || '';\n    buttonLibrary[name] = {title: title, command: command, styleClass: styleClass}\n    defaultButtonsList.push(name);\n  };\n\n  this.addCustomButton = function (name, pluginName) {\n    if(!name || !pluginName) {\n      throw 'Arguments \"name\" and \"pluginName\" are required';\n    }\n\n    buttonLibrary[name] = {pluginName: pluginName, isComplex: true};\n    defaultButtonsList.push(name);\n  };\n\n  this.$get = function () {\n    return {\n      getToolbarButtons: function(list) {\n        var toolbarButtons = [];\n        (list || defaultButtonsList).forEach(function(buttonKey) {\n          if(!buttonLibrary[buttonKey]) {\n            throw 'There is no \"' + buttonKey + '\" in your library. Possible variants: ' + Object.keys(buttonLibrary);\n          }\n\n          var button = angular.copy(buttonLibrary[buttonKey]);\n\n          if(!angular.isFunction(button.isActive)) {\n            button.isActive = isButtonActive;\n          }\n\n          toolbarButtons.push(button);\n        });\n        return toolbarButtons;\n      }\n    };\n  };\n\n});\nangular.module('ngWig')\n  .component('ngWig', {\n    bindings: {\n      content: '=ngModel',\n      options: '<?',\n      onPaste: '&',\n      buttons: '@',\n      beforeExecCommand: '&',\n      afterExecCommand: '&'\n    },\n    require: {\n      ngModelController: 'ngModel'\n    },\n    templateUrl: 'ng-wig/views/ng-wig.html',\n    controller: [\"$scope\", \"$element\", \"$q\", \"$attrs\", \"$window\", \"$document\", \"ngWigToolbar\", function($scope, $element, $q, $attrs, $window, $document, ngWigToolbar) {\n\n      var $container = angular.element($element[0].querySelector('#ng-wig-editable'));\n\n      //TODO: clean-up this attrs solution\n      this.required = 'required' in $attrs;\n      this.isSourceModeAllowed = 'sourceModeAllowed' in $attrs;\n      this.editMode = false;\n      this.toolbarButtons = ngWigToolbar.getToolbarButtons(this.buttons && string2array(this.buttons));\n      $attrs.$observe('disabled', (isDisabled) => {\n        this.disabled = isDisabled;\n        $container.attr('contenteditable', !isDisabled);\n      });\n      this.isEditorActive = () => $container[0] === $document[0].activeElement;\n      this.toggleEditMode = () => {\n        this.editMode = !this.editMode;\n        if ($window.getSelection().removeAllRanges) {\n          $window.getSelection().removeAllRanges();\n        }\n      };\n\n      this.execCommand = (command, options) => {\n        if (this.editMode) return false;\n\n        if (command === 'createlink') {\n          options = $window.prompt('Please enter the URL', 'http://');\n          if (!options) {\n            return;\n          }\n        }\n        this.beforeExecCommand({command: command, options: options});\n        $scope.$broadcast('execCommand', {command: command, options: options});\n        this.afterExecCommand({command: command, options: options});\n      };\n\n      this.$onInit = () => {\n        //model --> view\n        this.ngModelController.$render = () => $container.html(this.ngModelController.$viewValue || '');\n\n        $container.bind('blur keyup change focus click', () => {\n          //view --> model\n          this.ngModelController.$setViewValue($container.html());\n          $scope.$applyAsync();\n        });\n      };\n\n      $container.on('paste', (event) => {\n        if(!$attrs.onPaste){\n          return;\n        }\n\n        let pasteContent;\n        if (window.clipboardData && window.clipboardData.getData) { // IE\n          pasteContent = window.clipboardData.getData('Text');\n        }\n        else{\n          pasteContent = (event.originalEvent || event).clipboardData.getData('text/plain');\n        }\n        event.preventDefault();\n        $q.when(this.onPaste({$event: event, pasteContent: pasteContent})).then((pasteText) => {\n          pasteHtmlAtCaret(pasteText);\n        });\n      });\n\n      $scope.$on('execCommand', (event, params) => {\n        event.stopPropagation && event.stopPropagation();\n        $container[0].focus();\n\n        var ieStyleTextSelection = $document[0].selection,\n          command = params.command,\n          options = params.options;\n\n        if (ieStyleTextSelection) {\n          var textRange = ieStyleTextSelection.createRange();\n        }\n\n        if ($document[0].queryCommandSupported && !$document[0].queryCommandSupported(command)) {\n          throw 'The command \"' + command + '\" is not supported';\n        }\n\n        $document[0].execCommand(command, false, options);\n\n        if (ieStyleTextSelection) {\n          textRange.collapse(false);\n          textRange.select();\n        }\n      });\n\n    }]\n  });\n\n\n//TODO: check the function\nfunction string2array(keysString) {\n  return keysString.split(',').map(Function.prototype.call, String.prototype.trim);\n}\n\n\n//TODO: put contenteditable helper into service\nfunction pasteHtmlAtCaret(html) {\n  var sel, range;\n  if (window.getSelection) {\n    sel = window.getSelection();\n    if (sel.getRangeAt && sel.rangeCount) {\n      range = sel.getRangeAt(0);\n      range.deleteContents();\n\n      // Range.createContextualFragment() would be useful here but is\n      // non-standard and not supported in all browsers (IE9, for one)\n      var el = document.createElement(\"div\");\n      el.innerHTML = html;\n      var frag = document.createDocumentFragment(), node, lastNode;\n      while ( (node = el.firstChild) ) {\n        lastNode = frag.appendChild(node);\n      }\n      range.insertNode(frag);\n\n      // Preserve the selection\n      if (lastNode) {\n        range = range.cloneRange();\n        range.setStartAfter(lastNode);\n        range.collapse(true);\n        sel.removeAllRanges();\n        sel.addRange(range);\n      }\n    }\n  } else if (document.selection && document.selection.type != \"Control\") {\n    // IE < 9\n    document.selection.createRange().pasteHTML(html);\n  }\n}\nangular.module('ngWig')\n    .config(['ngWigToolbarProvider', function (ngWigToolbarProvider) {\n       ngWigToolbarProvider.addCustomButton('formats', 'nw-formats-button');\n    }])\n    .component('nwFormatsButton', {\n        bindings: {\n            execCommand: '=',\n            editMode: '=',\n            disabled: '='\n        },\n        template: `<select class=\"nw-select\" \n                           ng-model=\"$ctrl.format\" \n                           ng-change=\"$ctrl.execCommand(\\'formatblock\\', $ctrl.format.value)\" \n                           ng-options=\"format.name for format in $ctrl.formats\" \n                           ng-disabled=\"$ctrl.editMode || $ctrl.disabled\"></select>`,\n        controller: function() {\n\n            this.formats = [\n                {name: 'Normal text', value: 'p'},\n                {name: 'Header 1', value: 'h1'},\n                {name: 'Header 2', value: 'h2'},\n                {name: 'Header 3', value: 'h3'}\n            ];\n\n            this.format = this.formats[0];\n        }\n    });\n\n\nangular.module('ngwig-app-templates', ['ng-wig/views/ng-wig.html']);\n\nangular.module(\"ng-wig/views/ng-wig.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"ng-wig/views/ng-wig.html\",\n    \"<div class=\\\"ng-wig\\\">\\n\" +\n    \"  <ul class=\\\"nw-toolbar\\\">\\n\" +\n    \"    <li class=\\\"nw-toolbar__item\\\" ng-repeat=\\\"button in $ctrl.toolbarButtons\\\">\\n\" +\n    \"        <div ng-if=\\\"!button.isComplex\\\">\\n\" +\n    \"          <button type=\\\"button\\\"\\n\" +\n    \"                  class=\\\"nw-button {{button.styleClass}}\\\"\\n\" +\n    \"                  title=\\\"{{button.title}}\\\"\\n\" +\n    \"                  ng-click=\\\"$ctrl.execCommand(button.command)\\\"\\n\" +\n    \"                  ng-class=\\\"{ 'nw-button--active': !$ctrl.disabled && $ctrl.isEditorActive() && button.isActive() }\\\"\\n\" +\n    \"                  ng-disabled=\\\"$ctrl.editMode || $ctrl.disabled\\\">\\n\" +\n    \"            {{ button.title }}\\n\" +\n    \"          </button>\\n\" +\n    \"        </div>\\n\" +\n    \"        <div ng-if=\\\"button.isComplex\\\">\\n\" +\n    \"          <ng-wig-plugin\\n\" +\n    \"              exec-command=\\\"$ctrl.execCommand\\\"\\n\" +\n    \"              plugin=\\\"button\\\"\\n\" +\n    \"              editMode=\\\"$ctrl.editMode\\\"\\n\" +\n    \"              disabled=\\\"$ctrl.disabled\\\"\\n\" +\n    \"              options=\\\"$ctrl.options\\\"></ng-wig-plugin>\\n\" +\n    \"        </div>\\n\" +\n    \"    </li><!--\\n\" +\n    \"    --><li class=\\\"nw-toolbar__item\\\">\\n\" +\n    \"      <button type=\\\"button\\\"\\n\" +\n    \"              class=\\\"nw-button nw-button--source\\\"\\n\" +\n    \"              title=\\\"Edit HTML\\\"\\n\" +\n    \"              ng-class=\\\"{ 'nw-button--active': $ctrl.editMode }\\\"\\n\" +\n    \"              ng-if=\\\"$ctrl.isSourceModeAllowed\\\"\\n\" +\n    \"              ng-click=\\\"$ctrl.toggleEditMode()\\\"\\n\" +\n    \"              ng-disabled=\\\"$ctrl.disabled\\\">\\n\" +\n    \"        Edit HTML\\n\" +\n    \"      </button>\\n\" +\n    \"    </li>\\n\" +\n    \"  </ul>\\n\" +\n    \"\\n\" +\n    \"  <div class=\\\"nw-editor-container\\\">\\n\" +\n    \"    <div class=\\\"nw-editor__src-container\\\" ng-show=\\\"$ctrl.editMode\\\">\\n\" +\n    \"      <textarea ng-model=\\\"$ctrl.content\\\"\\n\" +\n    \"                ng-disabled=\\\"$ctrl.disabled\\\"\\n\" +\n    \"                class=\\\"nw-editor__src\\\"></textarea>\\n\" +\n    \"    </div>\\n\" +\n    \"    <div class=\\\"nw-editor\\\" ng-class=\\\"{ 'nw-disabled': $ctrl.disabled }\\\">\\n\" +\n    \"      <div id=\\\"ng-wig-editable\\\"\\n\" +\n    \"           tabindex=\\\"-1\\\"\\n\" +\n    \"           class=\\\"nw-editor__res\\\"\\n\" +\n    \"           ng-class=\\\"{'nw-invisible': $ctrl.editMode}\\\"\\n\" +\n    \"           ng-disabled=\\\"$ctrl.disabled\\\"\\n\" +\n    \"           contenteditable>\\n\" +\n    \"      </div>\\n\" +\n    \"    </div>\\n\" +\n    \"  </div>\\n\" +\n    \"</div>\\n\" +\n    \"\");\n}]);\n"]}